// This is an example config file detailing all of the supported standard actions 
// in the library.

{
  "activityType": "impressions",
  "items": [
    {
      // Source or destination fields may be required, based on the action types
      // used.  Neither is technically required.

      // (OPTIONAL) Source refers to the fields of the input record used in the following 
      // actions.
      "source": [ "inputFieldA", "inputFieldB" ],

      // (OPTIONAL) Destination is the name of the output field that these actions should 
      // generate in the output enriched record.
      //"destination": "output_field_name",

      // All the actions to perform, in sequence to process the source fields
      // (or create the destination output field).
      "actions": [

        // --------------------------------------------------------------------
        // Custom actions can have anything in the "config" section.
        // They must have a custom ActionCreator object passed to the ActionFactory.
        // If you notice you are re-using custom actions, they may be a candidate
        // to be added to the framework.
        {
          "actionType": "custom",
          "config": {
              "any": "thing",
              "someOther": [ "things" ]
          }
        },

        // --------------------------------------------------------------------
        // Simple copy copies each source field directly to the same-named 
        // field in the output record.
        // Requires "source" field[s].
        {
          "actionType": "simple-copy"
        },

        // --------------------------------------------------------------------
        // Copy copies the source fields to the destination.
        // Requires "source".
        {
          "actionType": "copy",
          "config": {
            "config": {
               "newName": "new_name_for_this_field_in_the_enriched_record"
            }
          }
        },

        // --------------------------------------------------------------------
        // "Replace Null With X" checks for a null value in the input field,
        // and if found, will set the enriched record's field value to be
        // "X".  (IE. whatever text is following the last dash in
        // "replace-null-with-X".
        // Requires "source" field[s].
        {
          "actionType": "replace-null-with-0"
        },

        // --------------------------------------------------------------------
        // Lookup 
        // Does a lookup into a pre-cached table.
        // Requires "source" field[s].
        {
          "actionType": "lookup",
          "config": {

            // If this fieled is present, the next two fields are ignored and
            // the lookup is done in (what is assumed to be) a JSON array of 
            // records (simulating an input record).  
            // This will be mostly used in tests.
            "lookupFile": "./path/to/a/local/file",

            // How to access the hive table to do the lookup.  If 
            // "lookupFile" is specified, these fields are ignored.
            "lookupDB": "als_search",
            "lookupTable": "local_offer_group",

            // Field to look up (lookup on the value of the source field).  
            // This field is always required.
            "lookupField": "ods_local_offer_id",

            // All of these fields (if found), will be selected and added to the 
            // enriched record:
            "fieldsToSelect": [
              "some_field",
              "some_other_field"
            ],

            // (OPTIONAL) If the lookup succeeds, all the actions in the onPass 
            // list will be run. 
            "onPass": [
              {
                "actionType": "custom-action",
                "config": { "key": "val" }
              },
              {
                "actionType": "custom-action2",
                "config": { "key": "val2" }
              }
            ],

            // (OPTIONAL) If the lookup fails, all the actions in the onFail list 
            // will be run. 
            "onFail": [
               {
                 "actionType": "custom-action",
                 "config": { "key": "val" }
               },
               {
                 "actionType": "reject",
                 "config": {
                   "reasonFrom": "lookup"
                 }
               }
            ]
          }
        },

        // --------------------------------------------------------------------
        // Reject 
        // 
        // One type of 'reason' field is required, but they are mutually exclusive;
        // so don't enter more than one:
        {
          "actionType": "reject",
          "config": {

            // Hard code the reason in the json.  This won't be modified by the
            // program or the framework at all.
            "reason": "Custom hard-coded reason.",

            // This option takes the reason from the last result string saved of 
            // this actionType.  (Each action caches a result string, if it succeeds
            // or fails).
            // For example, use the below in the onFail section of a lookup action:
            "reasonFrom": "lookup"
          }
        }
      ]
    }
  ]
}


